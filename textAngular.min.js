var textAngular=angular.module("textAngular",[]);textAngular.directive("compile",function(e){return function(t,n,r){t.$watch(function(e){return e.$eval(r.compile)},function(r){n.html(r);e(n.contents())(t)})}});textAngular.directive("textAngular",function(e,t,n,r){var i={theme:function(e,t){if(t.disableStyle){return false}e.theme=!!!t.theme?{}:t.theme;var n={resize:"both","overflow-y":"auto","min-height":"300px","text-align":"left",padding:"4px"};var r={margin:"0.2em","text-align":"right",overflow:"hidden","border-radius":"3px",display:"inline-block"};e.theme.editor=!!!e.theme.editor?{background:"#FFFFFF",color:"#5E5E5E",border:"1px solid #C4C4C4",padding:"4px",resize:"both","overflow-y":"auto","min-height":"300px","text-align":"left","border-radius":"3px"}:angular.extend(e.theme.editor,n);e.theme.toolbar=!!!e.theme.toolbar?{margin:"0.2em","text-align":"right",overflow:"hidden","border-radius":"3px",border:"1px #C4C4C4",display:"inline-block"}:angular.extend(e.theme.toolbar,r);e.theme.toolbarItems=!!!e.theme.toolbarItems?{cursor:"pointer",display:"inline-block",padding:"0.2em 0.4em","margin-left":"0em",background:"gray",color:"white","font-size":"14px"}:e.theme.toolbarItems;e.theme.insertForm=!!!e.theme.insertForm?{"text-align":"right",padding:"0.2em"}:e.theme.insertForm;e.theme.insertFormBtn=!!!e.theme.insertFormBtn?{"margin-top":"0.2em"}:e.theme.insertFormBtn},compileHtml:function(e,n){var r=$("<div>").append(n).html().replace(/(class="(.*?)")|(class='(.*?)')/g,"").replace(/</g,"<").replace(/>/g,">");if(e.showHtml=="load"){e.textAngularModel.text=t.trustAsHtml(r);e.textAngularModel.html=t.trustAsHtml(r.replace(/</g,"<"));e.showHtml=e.showHtmlDefault||false}else if(e.showHtml){e.textAngularModel.text=t.trustAsHtml(r)}else{e.textAngularModel.html=t.trustAsHtml(r.replace(/</g,"<"))}e.$parent.textAngularOpts.textAngularEditors[e.name]["html"]=r},wrapSelection:function(e,t){document.execCommand(e,false,t)},toolbarFn:{html:function(e,t){e.showHtml=!e.showHtml;if(e.showHtml){var n=$(t).find(".textAngular-text").html();r(function(){$(t).find(".textAngular-html").focus()},100)}else{var n=$(t).find(".textAngular-html").html();r(function(){$(t).find(".textAngular-text").focus()},100)}i.compileHtml(e,n)},h1:function(e){i.wrapSelection("formatBlock","<H1>")},h2:function(e){i.wrapSelection("formatBlock","<H2>")},h3:function(e){i.wrapSelection("formatBlock","<H3>")},p:function(e){i.wrapSelection("formatBlock","<P>")},pre:function(e){i.wrapSelection("formatBlock","<PRE>")},ul:function(e){i.wrapSelection("insertUnorderedList",null)},ol:function(e){i.wrapSelection("insertOrderedList",null)},quote:function(e){i.wrapSelection("formatBlock","<BLOCKQUOTE>")},undo:function(e){i.wrapSelection("undo",null)},redo:function(e){i.wrapSelection("redo",null)},b:function(e){i.wrapSelection("bold",null)},justifyLeft:function(e){i.wrapSelection("justifyLeft",null)},justifyRight:function(e){i.wrapSelection("justifyRight",null)},justifyCenter:function(e){i.wrapSelection("justifyCenter",null)},i:function(e){i.wrapSelection("italic",null)},clear:function(e){console.log("asdasd");i.wrapSelection("FormatBlock","<div>")},insertImage:function(e){if(e.inserting==true){e.inserting=false;return false}e.insert.model="";e.inserting=true;e.insert.text="Insert Image";e.currentInsert="insertImage"},insertHtml:function(e){if(e.inserting==true){e.inserting=false;return false}e.insert.model="";e.inserting=true;e.insert.text="Insert HTML";e.currentInsert="insertHtml"},createLink:function(e){if(e.inserting==true){e.inserting=false;return false}e.insert.model="";e.inserting=true;e.insert.text="Make a Link";e.currentInsert="createLink"}}};return{template:"<div class='textAngular-root' style='text-align:right;'><div class='textAngular-toolbar' ng-style='theme.toolbar'><span ng-repeat='toolbarItem in toolbar' title='toolbarItem.title' class='textAngular-toolbar-item' ng-style='theme.toolbarItems' ng-mousedown='runToolbar(toolbarItem.name,$event)' unselectable='on' compile='toolbarItem.title' name='toolbarItem.name'></span></div><form class='textAngular-insert' ng-show='inserting' ng-style='theme.insertForm'><input type='text' ng-model='insert.model' required><div class='textAngular-insert-submit'><button ng-style='theme.insertFormBtn' ng-mousedown='finishInsert();'>{{insert.text}}</button></div></form><pre contentEditable='true' ng-show='showHtml' class='textAngular-html' ng-style='theme.editor' ng-bind-html='textAngularModel.html' ></pre><div contentEditable='true' ng-hide='showHtml' class='textAngular-text' ng-style='theme.editor' ng-bind-html='textAngularModel.text' ></div></div>",replace:true,scope:{},restrict:"A",controller:function(e,t,n){console.log("Thank you for using textAngular! http://www.textangular.com");e.insert={};e.finishInsert=function(){i.wrapSelection(e.currentInsert,e.insert.model);e.inserting=false};e.runToolbar=function(n,r){r.preventDefault();var s=i.toolbarFn[n](e,t);if(n=="html")return;if(e.showHtml){var o=$(t).find(".textAngular-html").html()}else{var o=$(t).find(".textAngular-text").html()}i.compileHtml(e,o)}},link:function(e,t,n){e.$parent.$watch("textAngularOpts",function(){if(!!!e.$parent.textAngularOpts){console.log("No textAngularOpts config object found in scope! Please create one!")}e.showHtml="load";if(!!!n.textAngularName){console.log("No 'text-angular-name' directive found on directve root element. Please add one! ");return false}var r=n.textAngularName;e.name=r;if(!!!e.$parent.textAngularOpts.textAngularEditors)e.$parent.textAngularOpts.textAngularEditors={};if(!!!e.$parent.textAngularOpts.textAngularEditors[r]){e.$parent.textAngularOpts.textAngularEditors[r]={};var s=e.$parent.textAngularOpts;e.toolbar=e.$parent.textAngularOpts.toolbar}else{var s=e.$parent.textAngularOpts.textAngularEditors[r];e.toolbar=e.$parent.textAngularOpts.textAngularEditors[r].toolbar}i.theme(e,s);e.textAngularModel={};i.compileHtml(e,s.html);$(t).find(".textAngular-text,.textAngular-html").on("keyup",function(t){if(e.showHtml){var n=$(this.parentNode).find(".textAngular-html").html()}else{var n=$(this.parentNode).find(".textAngular-text").html()}e.$apply(i.compileHtml(e,n))})})}}})
